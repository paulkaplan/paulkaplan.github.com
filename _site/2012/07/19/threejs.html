<!DOCTYPE html>
<html>
  <head>
    <title>Playing with THREE.js and d3.js</title>
    <meta charset="utf-8" />
    <meta name="description" content="Personal website for Paul Kaplan" />
    <meta name="keywords" content="Paul,Kaplan,UChicago,University of Chicago, personal, interfaces" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
   
    <!--[if lte IE 9]><link rel="stylesheet" href="css/ie.css" type="text/css" media="screen" /><![endif]-->
    <link href="//fonts.googleapis.com/css?family=Open+Sans:400,300,600|Merriweather:400,300,700" rel="stylesheet" type="text/css">
    <link rel="stylesheet" href="/css/1140.css" type="text/css" media="screen" />
    <link rel="stylesheet" href="/css/styles.css" type="text/css" media="screen"/>
    <link rel="stylesheet" href="/css/syntax.css" type="text/css" media="screen"/>
    <link rel="stylesheet" href="/css/fonts.css" type="text/css" media="screen"/>
    <link rel="stylesheet" href="/css/fancybox.css" type="text/css" media="screen"/>
    
  </head>
  <body>
    <div class="container">
      <div class="row header">
        <div class="fourcol">
          <h1><span class="big">Paul Kaplan</span></h1>
          <h3><span>experimentalist programming</span></h3>
        </div>
        <div class="eightcol last"></div>
      </div>
      <div class="row content">
        <h2>Three.js and d3.js</h2>

<p><a href="LINK" title="three.js">Three.js</a> is a library for rendering 3D objects using the browser/hardware accelerated WebGL standard. It also abstracts over webGL by including an HTML5 CanvasRenderer as well. You can find examples of many other webGL projects of mine around (including <a href="LINK">Face Based Controllers</a>, <a href="LINK">iPhone Controls for HTML5 Games</a>). Let's see if we can put WebGL together with D3 by remaking the classic <strong>Three little circles</strong> tutorial from d3.</p>

<div id="chart"></div>


<p>Above is a very simple example of d3 I found <a href="http://bl.ocks.org/1062544">here</a>. After creating the SVG canvas and attaching a 'mousemove' event to it, we just define how to create each of the new particles when the mouse is moved.</p>

<div class="highlight"><pre><code class="js"><span class="kd">var</span> <span class="nx">z</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">category20c</span><span class="p">();</span> <span class="c1">// See link below</span>
<span class="nx">vis</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">&quot;mousemove&quot;</span><span class="p">,</span> <span class="nx">particle</span><span class="p">);</span>

<span class="kd">function</span> <span class="nx">particle</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">m</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">svg</span><span class="p">.</span><span class="nx">mouse</span><span class="p">(</span><span class="k">this</span><span class="p">);</span> <span class="c1">// Convenience method for mouse position</span>
                              <span class="c1">// returns [x,y]</span>
  <span class="nx">vis</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s2">&quot;svg:circle&quot;</span><span class="p">)</span>
      <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;cx&quot;</span><span class="p">,</span> <span class="nx">m</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
      <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;cy&quot;</span><span class="p">,</span> <span class="nx">m</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
      <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="nx">e</span><span class="o">-</span><span class="mi">6</span><span class="p">)</span>
      <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;fill-opacity&#39;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
      <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;fill&#39;</span><span class="p">,</span> <span class="nx">z</span><span class="p">(</span><span class="o">++</span><span class="nx">i</span><span class="p">))</span>
    <span class="p">.</span><span class="nx">transition</span><span class="p">()</span>
      <span class="p">.</span><span class="nx">duration</span><span class="p">(</span><span class="mi">2000</span><span class="p">)</span>
      <span class="p">.</span><span class="nx">ease</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">sqrt</span><span class="p">)</span>
      <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
      <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;fill-opacity&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="nx">e</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span>
      <span class="p">.</span><span class="nx">remove</span><span class="p">();</span>
<span class="p">}</span>
</code></pre>
</div>


<p><code>z</code> is just an array of 20 coordinated colors, you can find more information <a href="https://github.com/mbostock/d3/wiki/Ordinal-Scales#wiki-category20">here</a></p>

<p>Let's try that with three.js. First is the requisite simple rotating cube, just to get our feet wet. Skipping some of the code because it is all in the examples from the github page.</p>

<div id="three-d3-demo-simple"></div>




<div class="highlight"><pre><code class="js"><span class="kd">var</span> <span class="nx">camera</span><span class="p">,</span> <span class="nx">scene</span><span class="p">,</span> <span class="nx">renderer</span><span class="p">,</span> <span class="nx">mesh</span><span class="p">;</span>
<span class="kd">function</span> <span class="nx">init</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">scene</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">Scene</span><span class="p">();</span>
    
    <span class="nx">camera</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">PerspectiveCamera</span><span class="p">(</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1000</span> <span class="p">);</span>
  <span class="p">(...)</span>
    <span class="nx">geometry</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">CubeGeometry</span><span class="p">(</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">200</span> <span class="p">);</span>
    <span class="nx">material</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">MeshBasicMaterial</span><span class="p">(</span> <span class="p">{</span> <span class="nx">wireframe</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span> <span class="nx">color</span><span class="o">:</span> <span class="mh">0xffaaee</span><span class="p">});</span>
  <span class="p">(...)</span>
    <span class="nx">renderer</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">WebGLRenderer</span><span class="p">();</span>
  <span class="p">(...)</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">animate</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">requestAnimationFrame</span><span class="p">(</span> <span class="nx">animate</span> <span class="p">);</span>
    <span class="nx">mesh</span><span class="p">.</span><span class="nx">rotation</span><span class="p">.</span><span class="nx">x</span> <span class="o">+=</span> <span class="mf">0.005</span><span class="p">;</span>
    <span class="nx">mesh</span><span class="p">.</span><span class="nx">rotation</span><span class="p">.</span><span class="nx">y</span> <span class="o">+=</span> <span class="mf">0.01</span><span class="p">;</span>
    <span class="nx">renderer</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span> <span class="nx">scene</span><span class="p">,</span> <span class="nx">camera</span> <span class="p">);</span>
<span class="p">}</span>
</code></pre>
</div>




      </div>
    </div>
    <script src="/js/head.js" type="text/javascript"></script>
    <script type="text/javascript">
      head.js(
        { jquery   :   '/js/jquery.js' },
        // { fancybox :   '/js/fancybox.js'},
        { paul     :   '/js/paul.js'   }
        // 
        //   ,{ d3 : '/js/d3.js' }
        // 
        //   ,{ three : '/js/three.js' }
        // 
        //   ,{ example : '/js/example.js' }
        // 
        // 
        //   
        //     ,{ ccv : '/js/posts/20120725/ccv.js' }
        //   
        //     ,{ map : '/js/posts/20120725/map.js' }
        //   
        // 
        //   
        //     ,{ ccv : '/js/posts/20120725/ccv.js' }
        //   
        //     ,{ RAF : '/js/posts/common/requestAnimationFrame.js' }
        //   
        //     ,{ three : '/js/posts/common/three.js' }
        //   
        //     ,{ sine : '/js/posts/20120725/sine.js' }
        //   
        //     ,{ theremin : '/js/posts/20120725/theremin.js' }
        //   
        // 
        //   
        // 
        //   
        // 
        //   
        // 
        //   
        //     ,{ d3 : '/js/d3.js' }
        //   
        //     ,{ three : '/js/three.js' }
        //   
        //     ,{ example : '/js/example.js' }
        //   
        // 
        //   
        // 
        //   
        // 
      );
    </script>
    <script src="/js/mediaqueries.js" type="text/javascript"></script>
  </body>
</html>